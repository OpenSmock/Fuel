<!doctype html><html lang=en dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Migration # Often, we need to load objects whose class has changed since it was saved. This page documents how to load them in the different cases. Imagine we serialized an instance of Point and we need to materialize it when Point class has changed.
Shape Changes # Let&rsquo;s start with the easier cases. If a variable was inserted, its value will be nil, as no value for this variable exists in the serialized state."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content><meta property="og:description" content="Migration # Often, we need to load objects whose class has changed since it was saved. This page documents how to load them in the different cases. Imagine we serialized an instance of Point and we need to materialize it when Point class has changed.
Shape Changes # Let&rsquo;s start with the easier cases. If a variable was inserted, its value will be nil, as no value for this variable exists in the serialized state."><meta property="og:type" content="article"><meta property="og:url" content="https://theseion.github.io/Fuel/migration/"><meta property="article:section" content><meta property="article:modified_time" content="2024-01-20T19:41:22+01:00"><title>Migration | Fuel</title>
<link rel=manifest href=/Fuel/manifest.json><link rel=icon href=/Fuel/favicon.png type=image/x-icon><link rel=stylesheet href=/Fuel/book.min.4161ce72491bec8afb94acd3b81e1480e4774aca5e9e3e25c4eeeb0a4dff856a.css integrity="sha256-QWHOckkb7Ir7lKzTuB4UgOR3Sspenj4lxO7rCk3/hWo=" crossorigin=anonymous><script defer src=/Fuel/flexsearch.min.js></script><script defer src=/Fuel/en.search.min.d76f6c379e85b31a856bda08c54d4eb7a1de3245310309f70532b701ebdf9eec.js integrity="sha256-129sN56FsxqFa9oIxU1Ot6HeMkUxAwn3BTK3Aevfnuw=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a href=/Fuel/><img src=/Fuel/logo-fuel-header.png alt=Logo><span>Fuel</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://theseion.github.io/Fuel/builtin-header-support/>Builtin Header Support</a></li><li><a href=https://theseion.github.io/Fuel/customizing-the-graph/>Customizing the Graph</a></li><li><a href=https://theseion.github.io/Fuel/debugging/>Debugging</a></li><li><a href=https://theseion.github.io/Fuel/errors/>Errors</a></li><li><a href=https://theseion.github.io/Fuel/managing-globals/>Managing Globals</a></li><li><a href=https://theseion.github.io/Fuel/migration/ class=active>Migration</a></li><li><a href=https://theseion.github.io/Fuel/package-overview/>Package Overview</a></li><li><a href=https://theseion.github.io/Fuel/upgrading/>Upgrading</a></li><li><span>Releases</span><ul><li><a href=https://theseion.github.io/Fuel/releases/5.2.2/>5.2.2</a></li><li><a href=https://theseion.github.io/Fuel/releases/5.2.1/>5.2.1</a></li><li><a href=https://theseion.github.io/Fuel/releases/5.2.0/>5.2.0</a></li><li><a href=https://theseion.github.io/Fuel/releases/5.1.0/>5.1.0</a></li><li><a href=https://theseion.github.io/Fuel/releases/5.0.6/>5.0.6</a></li><li><a href=https://theseion.github.io/Fuel/releases/5.0.5/>5.0.5</a></li><li><a href=https://theseion.github.io/Fuel/releases/5.0.3/>5.0.3</a></li><li><a href=https://theseion.github.io/Fuel/releases/5.0.4/>5.0.4</a></li><li><a href=https://theseion.github.io/Fuel/releases/5.0.2/>5.0.2</a></li><li><a href=https://theseion.github.io/Fuel/releases/5.0.1/>5.0.1</a></li><li><a href=https://theseion.github.io/Fuel/releases/5.0.0/>5.0.0</a></li><li><a href=https://theseion.github.io/Fuel/releases/4.1.1/>4.1.1</a></li><li><a href=https://theseion.github.io/Fuel/releases/4.1.0/>4.1.0</a></li><li><a href=https://theseion.github.io/Fuel/releases/4.0.0/>4.0.0</a></li><li><a href=https://theseion.github.io/Fuel/releases/3.0.0/>3.0.0</a></li><li><a href=https://theseion.github.io/Fuel/releases/1.9.3/>1.9.3</a></li><li><a href=https://theseion.github.io/Fuel/releases/1.9/>1.9</a></li><li><a href=https://theseion.github.io/Fuel/releases/1.8/>1.8</a></li><li><a href=https://theseion.github.io/Fuel/releases/1.8.1/>1.8.1</a></li><li><a href=https://theseion.github.io/Fuel/releases/1.7/>1.7</a></li><li><a href=https://theseion.github.io/Fuel/releases/1.6/>1.6</a></li><li><a href=https://theseion.github.io/Fuel/releases/1.5/>1.5</a></li><li><a href=https://theseion.github.io/Fuel/releases/1.4/>1.4</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/Fuel/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Migration</strong>
<label for=toc-control><img src=/Fuel/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#shape-changes>Shape Changes</a></li></ul></nav></aside></header><article class=markdown><h1 id=migration>Migration
<a class=anchor href=#migration>#</a></h1><p>Often, we need to load objects whose class has changed since it was saved. This page documents how to load them in the different cases. Imagine we serialized an instance of <code>Point</code> and we need to materialize it when <code>Point</code> class has changed.</p><h2 id=shape-changes>Shape Changes
<a class=anchor href=#shape-changes>#</a></h2><p>Let&rsquo;s start with the easier cases. If a variable was inserted, its value will be <code>nil</code>, as no value for this variable exists in the serialized state. If a variable is removed, it is also obvious: the serialized value will be ignored. In the case where variables retained their names but changed order, Fuel also handles this automatically.</p><p>A more interesting case is when variables were renamed, where the user can map old names to new ones. For example, to map the values of the old variable names <code>x</code> and <code>y</code> to <code>posX</code> and <code>posY</code>, respectively, we would write:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-smalltalk data-lang=smalltalk><span style=display:flex><span><span style=color:#a6e22e>FLMaterializer</span> new
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>migrateClassNamed:</span> <span style=color:#e6db74>#Point</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>variables:</span> {<span style=color:#e6db74>&#39;x&#39;</span> <span style=color:#a6e22e>-&gt;</span> <span style=color:#e6db74>&#39;posX&#39;</span>. <span style=color:#e6db74>&#39;y&#39;</span> <span style=color:#a6e22e>-&gt;</span> <span style=color:#e6db74>&#39;posY&#39;</span>}.
</span></span></code></pre></div><p>Not surprisingly, if variables were renamed and no migration operation was specified, the change will be understood by Fuel as two independent operations, a removal (old variable names no longer exist), and an insertion (two new variables, both with values <code>nil</code>).</p><p>Class renaming operations should be specified this way:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-smalltalk data-lang=smalltalk><span style=display:flex><span><span style=color:#a6e22e>FLMaterializer</span> new
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>migrateClassNamed:</span> <span style=color:#e6db74>#Point</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>toClass:</span> <span style=color:#a6e22e>Coordinate</span>.
</span></span></code></pre></div><p>In addition to the methods mentioned above, the method <code>FLMaterializer>>#migrateClassNamed:toClass:variables:</code> can be used to combine both class and variable renaming operations.</p><p>Lastly, it is possible for clases to undergo layout changes. For example, <code>Point</code> could change from being fixed to variable. This specific case is also automatically handled by Fuel. Unfortunately, the inverse (variable to fixed) is not supported.</p><p>You can find tests related to this guide in <code>FLMigrationTest</code>. Additionally, the method <code>#FLMaterializer>>#environment:</code> can be useful for migrations: you can prepare an ad-hoc environment dictionary with the same keys that were used during serialization, but with the new classes as values.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/theseion/Fuel/commit/412ef093b2aed063b9293ca8d16ede33737b726e title='Last modified by Max Leske | Jan 20, 2024' target=_blank rel=noopener><img src=/Fuel/svg/calendar.svg class=book-icon alt=Calendar>
<span>Jan 20, 2024</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#shape-changes>Shape Changes</a></li></ul></nav></div></aside></main></body></html>